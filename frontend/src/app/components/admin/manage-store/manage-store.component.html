<div class="container mt-5">
  <h2 class="text-center mb-4">Manage Stores</h2>

  <!-- Tabs -->
  <ul class="nav nav-tabs justify-content-center store-tabs" id="storeTabs" role="tablist">
    <li class="nav-item">
      <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#active">Active</button>
    </li>
    <li class="nav-item">
      <button class="nav-link" data-bs-toggle="tab" data-bs-target="#inactive">Inactive</button>
    </li>
    <li class="nav-item">
      <button class="nav-link" data-bs-toggle="tab" data-bs-target="#maintenance">Maintenance</button>
    </li>
  </ul>

  <div class="tab-content mt-4">

    <!-- ACTIVE -->
    <div class="tab-pane fade show active" id="active">
      <div class="table-controls d-flex justify-content-between align-items-center mb-2">
        <mat-form-field appearance="outline" class="form-control-sm">
          <mat-label>Rows</mat-label>
          <mat-select [value]="pageSize" (selectionChange)="changePageSize($event.value, 'active')">
            <mat-option *ngFor="let size of pageSizeOptions" [value]="size">{{ size }}</mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline" class="form-control-sm">
          <mat-label>Search Active</mat-label>
          <input matInput (keyup)="applyFilter($event, 'active')" placeholder="Search stores">
        </mat-form-field>
      </div>

      <!-- Desktop Table -->
      <table mat-table [dataSource]="activeDS" matSort class="custom-table">
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>
          <td mat-cell *matCellDef="let s">{{ s.name }}</td>
        </ng-container>

        <ng-container matColumnDef="code">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Code</th>
          <td mat-cell *matCellDef="let s">{{ s.storeCode }}</td>
        </ng-container>

        <ng-container matColumnDef="address">
          <th mat-header-cell *matHeaderCellDef>Address</th>
          <td mat-cell *matCellDef="let s">{{ formatAddress(s) }}</td>
        </ng-container>

        <ng-container matColumnDef="workingHours">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Hours</th>
          <td mat-cell *matCellDef="let s">{{ getWorkingHours(s) }}</td>
        </ng-container>

        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>Actions</th>
          <td mat-cell *matCellDef="let s">
            <div class="action-buttons">
              <button class="btn btn-warning btn-sm" (click)="openEdit(s)">Update</button>
              <button class="btn btn-danger btn-sm" (click)="deleteStore(s._id)">Delete</button>
              <button class="btn btn-secondary btn-sm" (click)="maintenance(s._id)">Maint.</button>
            </div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>

      <!-- Mobile Cards -->
      <div class="mobile-cards">
        <div class="store-card" *ngFor="let s of activeDS.filteredData">
          <div><strong>Name:</strong> {{ s.name }}</div>
          <div><strong>Code:</strong> {{ s.storeCode }}</div>
          <div><strong>Address:</strong> {{ formatAddress(s) }}</div>
          <div><strong>Hours:</strong> {{ getWorkingHours(s) }}</div>
          <div class="action-buttons">
            <button class="btn btn-warning btn-sm" (click)="openEdit(s)">Update</button>
            <button class="btn btn-danger btn-sm" (click)="deleteStore(s._id)">Delete</button>
            <button class="btn btn-secondary btn-sm" (click)="maintenance(s._id)">Maint.</button>
          </div>
        </div>
      </div>

      <mat-paginator #activePaginator [pageSize]="pageSize" [pageSizeOptions]="pageSizeOptions" showFirstLastButtons></mat-paginator>
    </div>

    <!-- INACTIVE -->
    <div class="tab-pane fade" id="inactive">
      <div class="table-controls d-flex justify-content-between align-items-center mb-2">
        <mat-form-field appearance="outline" class="form-control-sm">
          <mat-label>Rows</mat-label>
          <mat-select [value]="pageSize" (selectionChange)="changePageSize($event.value, 'inactive')">
            <mat-option *ngFor="let size of pageSizeOptions" [value]="size">{{ size }}</mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline" class="form-control-sm">
          <mat-label>Search Inactive</mat-label>
          <input matInput (keyup)="applyFilter($event, 'inactive')" placeholder="Search stores">
        </mat-form-field>
      </div>

      <table mat-table [dataSource]="inactiveDS" matSort class="custom-table">
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>
          <td mat-cell *matCellDef="let s">{{ s.name }}</td>
        </ng-container>
        <ng-container matColumnDef="code">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Code</th>
          <td mat-cell *matCellDef="let s">{{ s.storeCode }}</td>
        </ng-container>
        <ng-container matColumnDef="address">
          <th mat-header-cell *matHeaderCellDef>Address</th>
          <td mat-cell *matCellDef="let s">{{ formatAddress(s) }}</td>
        </ng-container>
        <ng-container matColumnDef="workingHours">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Hours</th>
          <td mat-cell *matCellDef="let s">{{ getWorkingHours(s) }}</td>
        </ng-container>
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>Actions</th>
          <td mat-cell *matCellDef="let s">
            <div class="action-buttons">
              <button class="btn btn-warning btn-sm" (click)="openEdit(s)">Update</button>
              <button class="btn btn-danger btn-sm" (click)="deleteStore(s._id)">Delete</button>
              <button class="btn btn-secondary btn-sm" (click)="maintenance(s._id)">Maint.</button>
            </div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>

      <div class="mobile-cards">
        <div class="store-card" *ngFor="let s of inactiveDS.filteredData">
          <div><strong>Name:</strong> {{ s.name }}</div>
          <div><strong>Code:</strong> {{ s.storeCode }}</div>
          <div><strong>Address:</strong> {{ formatAddress(s) }}</div>
          <div><strong>Hours:</strong> {{ getWorkingHours(s) }}</div>
          <div class="action-buttons">
            <button class="btn btn-warning btn-sm" (click)="openEdit(s)">Update</button>
            <button class="btn btn-danger btn-sm" (click)="deleteStore(s._id)">Delete</button>
            <button class="btn btn-secondary btn-sm" (click)="maintenance(s._id)">Maint.</button>
          </div>
        </div>
      </div>

      <mat-paginator #inactivePaginator [pageSize]="pageSize" [pageSizeOptions]="pageSizeOptions" showFirstLastButtons></mat-paginator>
    </div>

    <!-- MAINTENANCE -->
    <div class="tab-pane fade" id="maintenance">
      <div class="table-controls d-flex justify-content-between align-items-center mb-2">
        <mat-form-field appearance="outline" class="form-control-sm">
          <mat-label>Rows</mat-label>
          <mat-select [value]="pageSize" (selectionChange)="changePageSize($event.value, 'maintenance')">
            <mat-option *ngFor="let size of pageSizeOptions" [value]="size">{{ size }}</mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline" class="form-control-sm">
          <mat-label>Search Maintenance</mat-label>
          <input matInput (keyup)="applyFilter($event, 'maintenance')" placeholder="Search stores">
        </mat-form-field>
      </div>

      <table mat-table [dataSource]="maintenanceDS" matSort class="custom-table">
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>
          <td mat-cell *matCellDef="let s">{{ s.name }}</td>
        </ng-container>
        <ng-container matColumnDef="code">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Code</th>
          <td mat-cell *matCellDef="let s">{{ s.storeCode }}</td>
        </ng-container>
        <ng-container matColumnDef="address">
          <th mat-header-cell *matHeaderCellDef>Address</th>
          <td mat-cell *matCellDef="let s">{{ formatAddress(s) }}</td>
        </ng-container>
        <ng-container matColumnDef="workingHours">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Hours</th>
          <td mat-cell *matCellDef="let s">{{ getWorkingHours(s) }}</td>
        </ng-container>
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>Actions</th>
          <td mat-cell *matCellDef="let s">
            <div class="action-buttons">
              <button class="btn btn-warning btn-sm" (click)="openEdit(s)">Update</button>
              <button class="btn btn-danger btn-sm" (click)="deleteStore(s._id)">Delete</button>
              <button class="btn btn-secondary btn-sm" (click)="maintenance(s._id)">Maint.</button>
            </div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>

      <div class="mobile-cards">
        <div class="store-card" *ngFor="let s of maintenanceDS.filteredData">
          <div><strong>Name:</strong> {{ s.name }}</div>
          <div><strong>Code:</strong> {{ s.storeCode }}</div>
          <div><strong>Address:</strong> {{ formatAddress(s) }}</div>
          <div><strong>Hours:</strong> {{ getWorkingHours(s) }}</div>
          <div class="action-buttons">
            <button class="btn btn-warning btn-sm" (click)="openEdit(s)">Update</button>
            <button class="btn btn-danger btn-sm" (click)="deleteStore(s._id)">Delete</button>
            <button class="btn btn-secondary btn-sm" (click)="maintenance(s._id)">Maint.</button>
          </div>
        </div>
      </div>

      <mat-paginator #maintenancePaginator [pageSize]="pageSize" [pageSizeOptions]="pageSizeOptions" showFirstLastButtons></mat-paginator>
    </div>

  </div>
</div>
